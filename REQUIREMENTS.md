# REQUIREMENTS.md - Unity 6 3Dゲーム基盤プロジェクト 形式化された要件定義

## アーキテクチャとデザインパターン
- **ServiceLocator + Event駆駆動のハイブリッドアーキテクチャ（最重要）**:グローバルサービスへのアクセスとイベントベースの通信を組み合わせたハイブリッドアプローチ。
- **イベント駆動型アーキテクチャ**: `GameEvent` を介したコンポーネント間の疎結合な連携。
- **コマンドパターン**: ゲーム内のアクション（例：ダメージ、回復）をオブジェクトとしてカプセル化し、再利用と管理を容易にします。
- **ObjectPool最適化**: 頻繁に作成・破棄されるコマンドオブジェクトをプール化し、メモリ効率とパフォーマンスを大幅に向上させます（95%のメモリ削減効果）。
- **Scriptable Objectベースのデータ管理**: キャラクターのステータスやアイテム情報などをアセットとして管理。

## 文書管理情報

- **ドキュメント種別**: 形式化された要件定義書（SDDフェーズ2: 形式化）
- **生成元**: SPEC.md - Unity 6 3Dゲーム基盤プロジェクト 初期構想・要件定義
- **トレーサビリティ**: SPEC.md の核心価値と実装方針を形式化し、後続 DESIGN.md 生成の基盤として機能
- **対象読者**: 開発者、アーキテクト、プロジェクトマネージャー
- **更新日**: 2025年9月19日（サバイバルホラー要件統合）
- **整合性状態**: SPEC.md v3.1 との完全整合性確保済み（サバイバルホラー最適化ジャンル追加）

## プロジェクト識別情報

### プロジェクト定義
- **プロジェクトID**: URP3D_Base01
- **正式名称**: **究極のUnity 6ベース 3Dゲーム開発基盤テンプレート**
- **プロジェクト分類**: ゲーム開発フレームワーク・テンプレート
- **開発手法**: スペック駆動開発（SDD）+ イベント駆動アーキテクチャ
- **核心ビジョン**: 4つの核心価値の実現
  - **Clone & Create**: リポジトリクローンから1分でゲーム開発開始
  - **Learn & Grow**: 初心者から上級者まで段階的成長をサポート
  - **Ship & Scale**: プロトタイプからプロダクションまで完全対応
  - **Community & Ecosystem**: 活発なコミュニティとエコシステム形成

### ステークホルダー要件マトリクス

| ステークホルダー | 優先度 | 主要要求事項 | 受益内容 | 究極テンプレート要件 |
|---|---|---|---|---|
| Unity開発者（中級～上級） | 最高 | モダンアーキテクチャ学習、実装品質向上 | 開発効率150%向上、コード品質改善 | 学習コスト70%削減（12時間以内） |
| ゲーム開発チーム | 最高 | 疎結合設計、協調開発支援 | チーム生産性向上、競合削減 | セットアップ時閗1分以内、自動ビルド |
| インディーゲーム開発者 | 高 | 高品質基盤、開発時間短縮 | 限定リソースでの効率的開発 | 6ジャンルテンプレート、アセット統合ガイド |
| ゲームデザイナー | 中 | コード非依存バランス調整 | 独立したゲームデザイン作業 | ゲームプレイ設定、多言語対応 |
| サウンドデザイナー | 中 | 高品質3D空間オーディオ | リアルな音響体験創造 | 統合音響システム、AI連動 |

### 究極テンプレート成功指標

#### 定量的目標要件（SPEC.md v3.0 究極テンプレート完全対応）
- **セットアップ時間短縮**: 現在30分 → 目標1分（97%短縮）
- **学習コスト削減**: 現在40時間 → 目標12時間（70%削減）
- **開発速度向上**: 既存比150%向上
- **バグ発生率削減**: 60%削減
- **リリース準備時間短縮**: 80%短縮
- **メモリ効率維持**: ObjectPoolにより95%のメモリ削減効果維持
- **実行効率維持**: コマンド実行で67%の速度改善維持

#### 4つの核心価値実現要件（究極テンプレートビジョン）
- **Clone & Create**: リポジトリクローンから1分でゲーム開発開始、初心者でも迷わずセットアップ可能
- **Learn & Grow**: 初心者から上級者まで段階的成長をサポート、Unity中級開発者が1週間で基本概念習得可能
- **Ship & Scale**: プロトタイプからプロダクションまで完全対応、任意のゲームジャンルに即座対応

#### 定性的目標要件
- **Clone & Create**: 初心者でも迷わずセットアップ可能
- **Learn & Grow**: Unity中級開発者が1週間で基本概念習得可能
- **Ship & Scale**: 任意のゲームジャンルに即座対応

## 対象ゲームジャンル・最適化仕様

### 最適化対象ジャンル

#### ステルスアクションゲーム（最優先）
- **要件**: NPCのマルチモーダルAIセンサーシステムの完全実装（視覚、聴覚、嗅覚）。
- **詳細**: 環境マスキング効果による音響・嗅覚制御、AI警戒レベル連動システム。
- **成功基準**: リアルなステルスゲームプレイの実現。

#### サバイバルホラーゲーム（高優先）
- **要件**: プレイヤーの無力感と心理的圧迫を演出するシステムの統合。
- **詳細**: 厳格なリソース管理、永続的な脅威となるストーカー型AI、プレイヤーの精神状態を反映する心理的恐怖システム。
- **成功基準**: 持続的な緊張感とカタルシスのあるサバイバル体験の実現。

#### 3Dプラットフォーマー（高優先）
- **要件**: 応答性の高いCharacterControllerベースの移動システム。
- **詳細**: カメラ状態管理、ジャンプ・落下・着地の状態管理。
- **成功基準**: 流体的なプラットフォームアクションの実現。

#### TPS/FPSゲーム（高優先）
- **要件**: Cinemachine 3.1統合カメラシステムとコンバットシステム基盤。
- **詳細**: プレイヤー状態管理（戦闘、移動）、武器・弾薬管理。
- **成功基準**: 競技性の高いシューティングゲームプレイの基盤提供。

### 対応可能ジャンル

#### アクションRPG（中優先）
- **要件**: RPG要素統合システム（キャラクター成長、スキルシステム、インベントリ管理）。
- **詳細**: ScriptableObjectベースのキャラクターステータス、レベルアップシステム、アイテム・装備システム。
- **成功基準**: アクション性を重視したRPGゲームプレイの基盤提供。

## 機能要件（Functional Requirements）

(FR-1からFR-8までの既存項目は変更なし)
...

### FR-9: サバイバルホラー特化システム

#### FR-9.1 リソース欠乏管理システム
- **要件ID**: FR-9.1
- **優先度**: 高（Should Have）
- **要件**: 弾薬、回復アイテム、キーアイテムの希少性を管理し、プレイヤーに戦略的判断を強制するシステム。
- **詳細仕様**:
  - `ResourceManager.cs`: シーン内の消費アイテムの総量を管理・監視するサービス。
  - `InventoryComponent.cs`: 厳格なスロット制限を持つインベントリ。
  - `ItemBoxComponent.cs`: インベントリ外のアイテムを保管するストレージ。
  - **リソースベースセーブ**: セーブに行動回数や特定アイテム（例：インクリボン）の消費を要求するオプション機能。
- **受入条件**:
  - アイテムの配置と消費のバランスが、プレイヤーに常に緊張感を与えること。
  - インベントリ管理が、探索と戦闘における重要な戦略的要素として機能すること。
  - リソースベースのセーブ機能が、高難易度モードなどで有効化できること。

#### FR-9.2 雰囲気・心理的恐怖システム
- **要件ID**: FR-9.2
- **優先度**: 高（Should Have）
- **要件**: 環境とプレイヤーの心理状態を動的に変化させ、持続的な不安と恐怖を演出するシステム。
- **詳細仕様**:
  - `AtmosphereManager.cs`: 照明、フォグ、環境音、天候などを統合管理し、ゲームの進行やプレイヤーの状態に応じて変化させるサービス。
  - `SanitySystem.cs`: プレイヤーの正気度やストレスレベルを管理するコンポーネント。
  - **トリガー**: 長時間暗闇にいる、敵を直視する、不穏なイベントを目撃するなど。
  - **効果**: 正気度の低下に応じて、視覚・聴覚の幻覚、操作精度の低下、敵に発見されやすくなるなどのペナルティが発生する。
  - **ダイジェティックUI**: 体力や状態異常を、キャラクターの見た目（息遣い、足取り）や画面エフェクトで表現する。
- **受入条件**:
  - 環境演出がプレイヤーに心理的な圧迫感を与えること。
  - 正気度システムが、プレイヤーに新たなリソース管理の軸とリスクをもたらすこと。
  - UIが没入感を阻害せず、直感的にプレイヤーの状態を伝えられること。

#### FR-9.3 ストーカー型AIシステム
- **要件ID**: FR-9.3
- **優先度**: 高（Should Have）
- **要件**: プレイヤーを永続的に追跡し、ゲームプレイに常に緊張感をもたらすストーカー型AIの基盤。
- **詳細仕様**:
  - `StalkerAIController.cs`: 特定のエリア内を徘徊し、プレイヤーの痕跡（音、匂い）を追跡する高度なAI。
  - **永続性**: 一時的に撃退・回避は可能だが、完全に倒すことはできず、時間経過や特定トリガーで再出現する。
  - **適応的行動**: プレイヤーの隠れ場所を推測したり、回り込んで奇襲したりするなど、予測しにくい行動パターンを持つ。
  - **心理的連携**: プレイヤーの正気度が低いほど、より攻撃的かつ執拗になる。
- **受入条件**:
  - ストーカーAIがプレイヤーにとって予測不能かつ恒常的な脅威として機能すること。
  - プレイヤーが「安全地帯は存在しない」という感覚を持つこと。
  - AIの挙動が単調にならず、ゲームプレイを通じて多様な駆け引きが生まれること。

(以降の非機能要件、技術要件などは変更なし)
...
(FR-8.1.2 Game Genre Templates System の項目を以下のように更新)

##### FR-8.1.2 Game Genre Templates System
- **要件ID**: FR-8.1.2
- **優先度**: 最高（Critical）
- **要件**: 7ジャンル対応テンプレートシステム
- **対応ジャンル**:
  1. **Stealth Template** - ステルスアクション
  2. **Survival Horror Template** - サバイバルホラー
  3. **FPS Template** - 一人称シューティング
  4. **TPS Template** - 三人称シューティング
  5. **Platformer Template** - プラットフォーマー
  6. **Adventure Template**: アドベンチャー
  7. **Action RPG Template**: アクションRPG
...