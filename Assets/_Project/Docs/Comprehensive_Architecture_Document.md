# Unity URP 3D Base Template - åŒ…æ‹¬çš„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

**ä½œæˆæ—¥**: 2025å¹´9æœˆ11æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Phase 1 - åå‰ç©ºé–“çµ±ä¸€å®Œäº†ç‰ˆ  
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: Unity 6 URP 3D Base Template

## æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Unity 6ã§æ§‹ç¯‰ã•ã‚ŒãŸ3Dã‚²ãƒ¼ãƒ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®åŒ…æ‹¬çš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è§£èª¬ã§ã™ã€‚ç¾åœ¨ã®å®Ÿè£…ã‚’æ­£è§£ã¨ã—ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­è¨ˆåŸå‰‡ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼ã‚’è©³ç´°ã«è¨˜è¿°ã—ã¾ã™ã€‚

## ç›®æ¬¡

1. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦)
2. [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¨ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†é›¢](#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¨ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†é›¢)
3. [æ ¸å¿ƒãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³](#æ ¸å¿ƒãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³)
4. [ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
5. [ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³](#ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³)
6. [ã‚³ãƒãƒ³ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³](#ã‚³ãƒãƒ³ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³)
7. [ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«](#ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«)
8. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼)
9. [ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
10. [ç§»è¡Œãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¾Œæ–¹äº’æ›æ€§](#ç§»è¡Œãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¾Œæ–¹äº’æ›æ€§)
11. [åå‰ç©ºé–“è¦ç´„](#åå‰ç©ºé–“è¦ç´„)
12. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³)

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### åŸºæœ¬å“²å­¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **ç–çµåˆãƒ»é«˜å‡é›†** ã®åŸå‰‡ã«åŸºã¥ãã€ä»¥ä¸‹ã®3ã¤ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã‚’çµ„ã¿åˆã‚ã›ã¦ã„ã¾ã™ï¼š

1. **ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ (Event-Driven Architecture)**
2. **ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ (Service Locator Pattern)**
3. **ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ (Layered Architecture)**

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æŸ±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Unity URP 3D Base Template          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Core Layer    â”‚ Features Layer  â”‚   Tests Layer       â”‚
â”‚                 â”‚                 â”‚                     â”‚
â”‚ â€¢ ServiceLoc.   â”‚ â€¢ Player        â”‚ â€¢ Unit Tests        â”‚
â”‚ â€¢ Events        â”‚ â€¢ AI            â”‚ â€¢ Integration Tests â”‚
â”‚ â€¢ Commands      â”‚ â€¢ UI            â”‚ â€¢ Performance Tests â”‚
â”‚ â€¢ Audio         â”‚ â€¢ Camera        â”‚                     â”‚
â”‚ â€¢ Data          â”‚                 â”‚                     â”‚
â”‚ â€¢ Helpers       â”‚                 â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¨ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†é›¢

### ç‰©ç†çš„æ§‹é€ 

```
Assets/_Project/
â”œâ”€â”€ Core/                           # æ ¸å¿ƒã‚·ã‚¹ãƒ†ãƒ ï¼ˆå…±é€šåŸºç›¤ï¼‰
â”‚   â”œâ”€â”€ Audio/                      # ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ Commands/                   # ã‚³ãƒãƒ³ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…
â”‚   â”œâ”€â”€ Events/                     # ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ Services/                   # ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…
â”‚   â”œâ”€â”€ Helpers/                    # ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹
â”‚   â”œâ”€â”€ Lifecycle/                  # ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
â”‚   â”œâ”€â”€ ServiceLocator.cs           # ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼
â”‚   â”œâ”€â”€ FeatureFlags.cs            # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ•ãƒ©ã‚°
â”‚   â”œâ”€â”€ GameManager.cs             # ã‚²ãƒ¼ãƒ çµ±æ‹¬ç®¡ç†
â”‚   â””â”€â”€ SystemInitializer.cs       # ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
â”œâ”€â”€ Features/                       # æ©Ÿèƒ½å®Ÿè£…ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å›ºæœ‰ï¼‰
â”‚   â”œâ”€â”€ Player/                     # ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ©Ÿèƒ½
â”‚   â”œâ”€â”€ AI/                         # AIæ©Ÿèƒ½
â”‚   â”œâ”€â”€ UI/                         # UIæ©Ÿèƒ½
â”‚   â””â”€â”€ Camera/                     # ã‚«ãƒ¡ãƒ©æ©Ÿèƒ½
â”œâ”€â”€ Tests/                          # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ Core/                       # Coreãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ Features/                   # Featuresãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ Integration/                # çµåˆãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ Performance/                # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
â””â”€â”€ Docs/                          # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    â”œâ”€â”€ Architecture_Policies.md
    â””â”€â”€ Works/                      # ä½œæ¥­ãƒ­ã‚°ä¿ç®¡åº«
```

### ä¾å­˜é–¢ä¿‚åˆ¶ç´„

```
Features Layer
    â†“ (ä¾å­˜è¨±å¯)
Core Layer
    â†‘ (ä¾å­˜ç¦æ­¢)
Features Layer

Tests Layer â†’ Core Layer (OK)
Tests Layer â†’ Features Layer (OK)
```

**é‡è¦**: Coreå±¤ã‹ã‚‰Featureså±¤ã¸ã®ä¾å­˜ã¯ **å³æ ¼ã«ç¦æ­¢** ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

## æ ¸å¿ƒãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. Service Locator Pattern

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/ServiceLocator.cs:11`

```csharp
public static class ServiceLocator
{
    private static readonly Dictionary<Type, object> services = new Dictionary<Type, object>();
    private static readonly Dictionary<Type, Func<object>> factories = new Dictionary<Type, Func<object>>();
    private static readonly object lockObject = new object();
    
    public static void RegisterService<T>(T service) where T : class { /* ... */ }
    public static T GetService<T>() where T : class { /* ... */ }
    public static T RequireService<T>() where T : class { /* ... */ }
}
```

**ç‰¹å¾´**:
- **ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•**: `lockObject`ã«ã‚ˆã‚‹åŒæœŸåˆ¶å¾¡
- **ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ã‚µãƒãƒ¼ãƒˆ**: é…å»¶åˆæœŸåŒ–å¯¾å¿œ
- **å‹å®‰å…¨**: ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã«ã‚ˆã‚‹å‹ãƒã‚§ãƒƒã‚¯

### 2. Event-Driven Architecture

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Events/GameEvent.cs:13`

```csharp
[CreateAssetMenu(fileName = "New Game Event", menuName = "asterivo.Unity60/Events/Game Event")]
public class GameEvent : ScriptableObject
{
    private readonly HashSet<GameEventListener> listeners = new HashSet<GameEventListener>();
    private List<GameEventListener> sortedListeners;
    private bool isDirty = true;
    
    public void Raise() { /* å„ªå…ˆåº¦é †å®Ÿè¡Œ */ }
    public System.Collections.IEnumerator RaiseAsync() { /* éåŒæœŸå®Ÿè¡Œ */ }
}
```

**ç‰¹å¾´**:
- **ScriptableObjectãƒ™ãƒ¼ã‚¹**: ã‚¢ã‚»ãƒƒãƒˆã¨ã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆå®šç¾©ã‚’ç®¡ç†
- **å„ªå…ˆåº¦ä»˜ããƒªã‚¹ãƒŠãƒ¼**: `Priority`ã«ã‚ˆã‚‹å®Ÿè¡Œé †åˆ¶å¾¡
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: `HashSet`ã«ã‚ˆã‚‹é«˜é€Ÿç®¡ç†
- **éåŒæœŸã‚µãƒãƒ¼ãƒˆ**: ãƒ•ãƒ¬ãƒ¼ãƒ åˆ†æ•£å®Ÿè¡Œ

### 3. Command Pattern

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Commands/ICommand.cs:6`

```csharp
public interface ICommand
{
    void Execute();
    void Undo();
    bool CanUndo { get; }
}
```

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Commands/CommandInvoker.cs:15`

```csharp
public class CommandInvoker : MonoBehaviour, IGameEventListener<ICommand>
{
    private Stack<ICommand> undoStack = new Stack<ICommand>();
    private Stack<ICommand> redoStack = new Stack<ICommand>();
    
    public void ExecuteCommand(ICommand command) { /* å®Ÿè¡Œãƒ»å±¥æ­´ç®¡ç† */ }
    public bool Undo() { /* å…ƒã«æˆ»ã™ */ }
    public bool Redo() { /* ã‚„ã‚Šç›´ã— */ }
}
```

**ç‰¹å¾´**:
- **Undo/Redoå¯¾å¿œ**: ã‚¹ã‚¿ãƒƒã‚¯æ§‹é€ ã«ã‚ˆã‚‹å±¥æ­´ç®¡ç†
- **ã‚¤ãƒ™ãƒ³ãƒˆçµ±åˆ**: `IGameEventListener<ICommand>`å®Ÿè£…
- **å±¥æ­´ã‚µã‚¤ã‚ºåˆ¶é™**: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡åˆ¶å¾¡

---

## ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼å›³

```
[User Input] â†’ [PlayerController] â†’ [CommandDefinitionGameEvent]
                      â†“
[GameManager] â† [IGameEventListener<ICommandDefinition>]
                      â†“
[CommandInvoker] â† [ICommand Creation] â†’ [Command.Execute()]
                      â†“
[Game State Changes] â†’ [GameStateEvent] â†’ [UI Updates]
                      â†“                    â†“
                [Audio Events]        [Visual Effects]
```

### ã‚¤ãƒ™ãƒ³ãƒˆã®ç¨®é¡

1. **åŸºæœ¬ã‚¤ãƒ™ãƒ³ãƒˆ (`GameEvent`)**
   - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã—
   - çŠ¶æ…‹å¤‰åŒ–é€šçŸ¥ç”¨

2. **å‹ä»˜ãã‚¤ãƒ™ãƒ³ãƒˆ (`GenericGameEvent<T>`)**
   - å‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿å—ã‘æ¸¡ã—
   - `CommandDefinitionGameEvent`, `GameStateEvent`ç­‰

3. **ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ£ãƒãƒ« (`EventChannelSO`)**
   - ScriptableObjectãƒ™ãƒ¼ã‚¹ã®é€šä¿¡ãƒãƒ£ãƒãƒ«
   - ã‚¨ãƒ‡ã‚£ã‚¿ã§ã®è¦–è¦šçš„ç®¡ç†

### ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œãƒ•ãƒ­ãƒ¼

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Events/GameEvent.cs:35`

```csharp
public void Raise()
{
    // å„ªå…ˆåº¦ã§ã‚½ãƒ¼ãƒˆï¼ˆå¿…è¦æ™‚ã®ã¿ï¼‰
    if (isDirty) { RebuildSortedList(); }
    
    // é€†é †ã§å®Ÿè¡Œï¼ˆãƒªã‚¹ãƒŠãƒ¼ãŒè‡ªèº«ã‚’å‰Šé™¤ã—ã¦ã‚‚å®‰å…¨ï¼‰
    for (int i = sortedListeners.Count - 1; i >= 0; i--)
    {
        if (sortedListeners[i] != null && sortedListeners[i].enabled)
        {
            sortedListeners[i].OnEventRaised();
        }
    }
}
```

---

## ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³

### ã‚µãƒ¼ãƒ“ã‚¹ç™»éŒ²ãƒ•ãƒ­ãƒ¼

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Audio/Services/AudioService.cs:74`

```csharp
private void Awake()
{
    // ServiceLocatorã«ç™»éŒ²
    if (FeatureFlags.UseServiceLocator)
    {
        ServiceLocator.RegisterService<IAudioService>(this);
        
        if (FeatureFlags.EnableDebugLogging)
        {
            EventLogger.Log("[AudioService] Registered to ServiceLocator");
        }
    }
}
```

### ã‚µãƒ¼ãƒ“ã‚¹å–å¾—ãƒ‘ã‚¿ãƒ¼ãƒ³

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Helpers/ServiceHelper.cs:12`

```csharp
public static T GetServiceWithFallback<T>() where T : class
{
    // ServiceLocatorä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
    if (CoreFeatureFlags.UseServiceLocator)
    {
        var service = ServiceLocator.GetService<T>();
        if (service != null) 
        {
            LogServiceAcquisition<T>("ServiceLocator");
            return service;
        }
    }
    
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: Unityæ¨™æº–æ¤œç´¢ï¼ˆé–‹ç™ºãƒ“ãƒ«ãƒ‰/ã‚¨ãƒ‡ã‚£ã‚¿é™å®šï¼‰
    #if UNITY_EDITOR || DEVELOPMENT_BUILD
    if (typeof(T).IsSubclassOf(typeof(UnityEngine.Object)))
    {
        var unityObject = UnityEngine.Object.FindFirstObjectByType(typeof(T)) as T;
        if (unityObject != null)
        {
            LogServiceAcquisition<T>("FindFirstObjectByType");
        }
        return unityObject;
    }
    #endif

    LogServiceNotFound<T>();
    return null;
}
```

### ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§

| ã‚µãƒ¼ãƒ“ã‚¹ | ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ | å®Ÿè£…ã‚¯ãƒ©ã‚¹ | è²¬ä»» |
|---------|-----------------|-----------|------|
| Audio | `IAudioService` | `AudioService` | éŸ³éŸ¿åˆ¶å¾¡ |
| Game State | `IGameStateManager` | `GameStateManagerService` | çŠ¶æ…‹ç®¡ç† |
| Scene Loading | `ISceneLoadingService` | `SceneLoadingService` | ã‚·ãƒ¼ãƒ³é·ç§» |
| Score | `IScoreService` | `ScoreService` | ã‚¹ã‚³ã‚¢ç®¡ç† |
| Pause | `IPauseService` | `PauseService` | ãƒãƒ¼ã‚ºåˆ¶å¾¡ |

---

## ã‚³ãƒãƒ³ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³

### ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

```
[Player Input] â†’ [PlayerController.OnMove()]
                       â†“
[MoveCommandDefinition] â†’ [CommandDefinitionGameEvent.Raise()]
                       â†“
[GameManager.OnEventRaised()] â†’ [CreateCommandFromDefinition()]
                       â†“
[ICommand.Execute()] â†’ [Game Logic Execution]
                       â†“
[CommandInvoker.ExecuteCommand()] â†’ [Undo Stack Push]
```

### ã‚³ãƒãƒ³ãƒ‰ç¨®é¡

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Features/Player/Scripts/PlayerController.cs:120`

```csharp
// ç§»å‹•ã‚³ãƒãƒ³ãƒ‰
var definition = new MoveCommandDefinition(MoveCommandDefinition.MoveType.Walk, new Vector3(moveInput.x, 0, moveInput.y));
onCommandDefinitionIssued?.Raise(definition);

// ã‚¸ãƒ£ãƒ³ãƒ—ã‚³ãƒãƒ³ãƒ‰  
var definition = new JumpCommandDefinition();
onCommandDefinitionIssued?.Raise(definition);
```

### Undo/Redoæ©Ÿèƒ½

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Commands/CommandInvoker.cs:80`

```csharp
public bool Undo()
{
    if (!CanUndo) return false;
        
    var command = undoStack.Pop();
    command.Undo();

    if (command.CanUndo && enableRedo)
    {
        redoStack.Push(command);
    }
    
    BroadcastHistoryChanges();
    return true;
}
```

---

## ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«

### åˆæœŸåŒ–å„ªå…ˆåº¦ã‚·ã‚¹ãƒ†ãƒ 

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/IInitializable.cs:6`

```csharp
public interface IInitializable
{
    int Priority { get; }        // ä½ã„å€¤ã»ã©å…ˆã«åˆæœŸåŒ–
    void Initialize();
    bool IsInitialized { get; }
}
```

### SystemInitializer ã«ã‚ˆã‚‹çµ±åˆç®¡ç†

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/SystemInitializer.cs:52`

```csharp
private void DiscoverSystems()
{
    // å­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰åˆæœŸåŒ–å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ¢ç´¢
    var components = GetComponentsInChildren<MonoBehaviour>(true);
    
    foreach (var component in components)
    {
        if (component is IInitializable initializable)
        {
            initializableSystems.Add(initializable);
            systemComponents.Add(component);
        }
    }
    
    // å„ªå…ˆåº¦ã§ã‚½ãƒ¼ãƒˆ
    initializableSystems = initializableSystems.OrderBy(s => s.Priority).ToList();
}
```

### ã‚µãƒ¼ãƒ“ã‚¹ç™»éŒ²ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Lifecycle/IServiceLocatorRegistrable.cs:5`

```csharp
public interface IServiceLocatorRegistrable
{
    int Priority { get; }
    void RegisterServices();
    void UnregisterServices();
}
```

### åˆæœŸåŒ–é †åºä¾‹

```
Priority 0: CoreFeatureFlags
Priority 5: AudioManager (IAudioService)  
Priority 10: AudioService (IAudioService backup)
Priority 15: GameStateManagerService
Priority 20: SceneLoadingService
Priority 25: UIService
...
Priority N: Feature-specific services
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼

### ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
[User Input] 
    â†“
[InputSystem] â†’ [PlayerController]
    â†“
[Command Definition] â†’ [CommandDefinitionGameEvent]
    â†“
[GameManager] â†’ [Command Creation] â†’ [CommandInvoker]
    â†“
[Command.Execute()] â†’ [Game State Change]
    â†“
[Service Notifications] â†’ [UI Updates] + [Audio Updates] + [Visual Updates]
```

### éŸ³éŸ¿ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
[Game State Change] â†’ [GameStateEvent]
                           â†“
[AudioService.UpdateGameState()] â†’ [BGMManager] + [AmbientManager] + [EffectManager]
                           â†“                     â†“                    â†“
[Stealth Integration] â†’ [StealthAudioCoordinator] â†’ [SpatialAudio] â†’ [NPCs Audio Detection]
```

### ã‚¤ãƒ™ãƒ³ãƒˆä¼æ’­ãƒ‘ã‚¿ãƒ¼ãƒ³

1. **åŒæœŸã‚¤ãƒ™ãƒ³ãƒˆ**: å³åº§ã«å…¨ãƒªã‚¹ãƒŠãƒ¼ã«é€šçŸ¥
2. **éåŒæœŸã‚¤ãƒ™ãƒ³ãƒˆ**: ãƒ•ãƒ¬ãƒ¼ãƒ åˆ†æ•£ã«ã‚ˆã‚‹è² è·è»½æ¸›
3. **å„ªå…ˆåº¦ä»˜ãã‚¤ãƒ™ãƒ³ãƒˆ**: é‡è¦åº¦é †ã§ã®å®Ÿè¡Œåˆ¶å¾¡

---

## ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### éšå±¤æ§‹é€ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 AudioManager (Top Level)                â”‚
â”‚                 Implements: IAudioService                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   BGMManager    â”‚ AmbientManager  â”‚  EffectManager      â”‚
â”‚   (Background)  â”‚ (Environment)   â”‚  (Sound Effects)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SpatialAudioMgr â”‚DynamicAudioEnv  â”‚StealthAudioCoord    â”‚
â”‚ (3D Positioning)â”‚(Adaptive Audio) â”‚(Stealth Detection)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Singleton â†’ Service Locatorç§»è¡Œ

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/Audio/AudioManager.cs:18`

```csharp
[System.Obsolete("Use ServiceLocator.GetService<IAudioService>() instead")]
public static AudioManager Instance 
{
    get 
    {
        // Legacy Singletonå®Œå…¨ç„¡åŠ¹åŒ–ãƒ•ãƒ©ã‚°ã®ç¢ºèª
        if (FeatureFlags.DisableLegacySingletons) 
        {
            EventLogger.LogError("[DEPRECATED] AudioManager.Instance is disabled. Use ServiceLocator.GetService<IAudioService>() instead");
            return null;
        }
        
        // ç§»è¡Œè­¦å‘Šã®è¡¨ç¤º
        if (FeatureFlags.EnableMigrationWarnings) 
        {
            EventLogger.LogWarning("[DEPRECATED] AudioManager.Instance usage detected. Please migrate to ServiceLocator.GetService<IAudioService>()");
        }
        
        return instance;
    }
}
```

### ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼

```
[Game Event] â†’ [AudioService] â†’ [Audio Category Manager]
                    â†“                      â†“
[Volume Control] â†’ [AudioMixer] â†’ [Unity Audio Engine]
                    â†“
[Stealth Detection] â†’ [NPCAudioSensor] â†’ [AI Behavior]
```

---

## ç§»è¡Œãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¾Œæ–¹äº’æ›æ€§

### æ®µéšçš„ç§»è¡Œæˆ¦ç•¥

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Features/Player/Scripts/PlayerController.cs:62`

```csharp
private void InitializeAudioServices()
{
    // æ–°ã—ã„æ–¹æ³•ã§ã®å–å¾— (æ¨å¥¨) - ServiceLocatorå„ªå…ˆ
    if (useServiceLocator && FeatureFlags.UseServiceLocator) 
    {
        try
        {
            audioService = ServiceLocator.GetService<IAudioService>();
            if (audioService != null)
            {
                audioServiceStatus = "ServiceLocator: Success";
                return; // æ­£å¸¸ã«å–å¾—ã§ããŸã®ã§çµ‚äº†
            }
        }
        catch (System.Exception ex)
        {
            EventLogger.LogWarning($"ServiceLocator audio service failed: {ex.Message}");
        }
    }
    
    // å¾“æ¥ã®æ–¹æ³• (å¾Œæ–¹äº’æ›æ€§) - Singleton ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
    if (!FeatureFlags.DisableLegacySingletons)
    {
        try 
        {
#pragma warning disable CS0618 // Obsolete warning suppression during migration
            var audioManager = FindFirstObjectByType<asterivo.Unity60.Core.Audio.AudioManager>();
            if (audioManager != null)
            {
                audioService = audioManager;
                audioServiceStatus = "Legacy Singleton: Success";
            }
#pragma warning restore CS0618
        }
        catch (System.Exception ex)
        {
            EventLogger.LogError($"Legacy audio service fallback failed: {ex.Message}");
        }
    }
}
```

### ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ•ãƒ©ã‚°ã«ã‚ˆã‚‹åˆ¶å¾¡

**å®Ÿè£…å ´æ‰€**: `Assets/_Project/Core/FeatureFlags.cs`

```csharp
public static class FeatureFlags
{
    public static bool UseServiceLocator { get => PlayerPrefs.GetInt("FeatureFlag_UseServiceLocator", 1) == 1; set => SetFlag("FeatureFlag_UseServiceLocator", value); }
    public static bool EnableMigrationWarnings { get => PlayerPrefs.GetInt("FeatureFlag_EnableMigrationWarnings", 1) == 1; set => SetFlag("FeatureFlag_EnableMigrationWarnings", value); }
    public static bool DisableLegacySingletons { get => PlayerPrefs.GetInt("FeatureFlag_DisableLegacySingletons", 0) == 1; set => SetFlag("FeatureFlag_DisableLegacySingletons", value); }
}
```

### ç§»è¡Œæ®µéš

1. **Phase 1**: åå‰ç©ºé–“çµ±ä¸€ âœ… å®Œäº†
2. **Phase 2**: Service Locatorå®Ÿè£…ãƒ»Singletonä½µå­˜
3. **Phase 3**: Singletonæ®µéšçš„å»ƒæ­¢
4. **Phase 4**: å®Œå…¨Service Locatorç§»è¡Œ

---

## åå‰ç©ºé–“è¦ç´„

### çµ±ä¸€ãƒ‘ã‚¿ãƒ¼ãƒ³

```csharp
// Root namespace
namespace asterivo.Unity60

// Core layer - ã‚·ã‚¹ãƒ†ãƒ åŸºç›¤
namespace asterivo.Unity60.Core
namespace asterivo.Unity60.Core.Audio
namespace asterivo.Unity60.Core.Events
namespace asterivo.Unity60.Core.Commands
namespace asterivo.Unity60.Core.Services

// Features layer - ãƒ‰ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½
namespace asterivo.Unity60.Features.Player
namespace asterivo.Unity60.Features.AI
namespace asterivo.Unity60.Features.UI

// Tests layer - ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
namespace asterivo.Unity60.Tests.Core
namespace asterivo.Unity60.Tests.Features
namespace asterivo.Unity60.Tests.Integration
```

### ç§»è¡ŒçŠ¶æ³

- âœ… **å®Œäº†**: Coreå±¤ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ã®åå‰ç©ºé–“çµ±ä¸€
- âœ… **å®Œäº†**: Featureså±¤ã®åå‰ç©ºé–“çµ±ä¸€  
- âœ… **å®Œäº†**: Testså±¤ã®åå‰ç©ºé–“çµ±ä¸€
- âœ… **å®Œäº†**: AIæ©Ÿèƒ½ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ã®é…ç½®ä¿®æ­£

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

### ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å›³

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          Unity URP 3D Game          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           GameManager               â”‚
                    â”‚    (Central Orchestrator)           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                      â”‚                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ServiceLocator   â”‚   â”‚  EventSystem    â”‚   â”‚ CommandInvoker  â”‚
    â”‚   (DI Container)  â”‚   â”‚ (Event Bus)     â”‚   â”‚ (Action Queue)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                      â”‚                     â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Services      â”‚            â”‚           â”‚     Commands      â”‚
    â”‚                   â”‚            â”‚           â”‚                   â”‚
    â”‚ â€¢ IAudioService   â”‚            â”‚           â”‚ â€¢ MoveCommand     â”‚
    â”‚ â€¢ IGameStateMan.  â”‚            â”‚           â”‚ â€¢ JumpCommand     â”‚
    â”‚ â€¢ ISceneLoading   â”‚            â”‚           â”‚ â€¢ DamageCommand   â”‚
    â”‚ â€¢ IScoreService   â”‚            â”‚           â”‚ â€¢ HealCommand     â”‚
    â”‚ â€¢ IPauseService   â”‚            â”‚           â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚         Event Types          â”‚
                      â”‚                              â”‚
                      â”‚ â€¢ GameEvent                 â”‚
                      â”‚ â€¢ GameStateEvent            â”‚
                      â”‚ â€¢ CommandDefinitionEvent    â”‚
                      â”‚ â€¢ PlayerDataEvent           â”‚
                      â”‚ â€¢ FloatGameEvent            â”‚
                      â”‚ â€¢ StringGameEvent           â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ãƒ•ãƒ­ãƒ¼è©³ç´°å›³

```
[Player Input] â”€â”€â–º [InputSystem] â”€â”€â–º [PlayerController]
                                            â”‚
                                            â–¼
                                   [CommandDefinition]
                                            â”‚
                                            â–¼
                                [CommandDefinitionGameEvent] â”€â”€â–º [Event Bus]
                                            â”‚                        â”‚
                                            â–¼                        â–¼
                                    [GameManager]              [Other Listeners]
                                            â”‚
                                            â–¼
                                [CreateCommandFromDefinition]
                                            â”‚
                                            â–¼
                                     [ICommand.Execute]
                                            â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                                    â–¼               â–¼
                            [Game Logic]    [CommandInvoker]
                            [Updates]       [History Stack]
                                    â”‚               â”‚
                                    â–¼               â–¼
                            [State Changes]  [Undo/Redo]
                                    â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
                            â–¼       â–¼       â–¼
                        [Audio] [Visual] [UI]
                        Events   Effects  Updates
```

### ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼è©³ç´°å›³

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          ServiceLocator             â”‚
                    â”‚   (Static Class - Thread Safe)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Dictionary<Type, object>         â”‚
                    â”‚         services                    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                            â”‚                            â”‚
        â–¼                            â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AudioService â”‚            â”‚GameStateMgr  â”‚            â”‚SceneLoading  â”‚
â”‚implements    â”‚            â”‚implements    â”‚            â”‚implements    â”‚
â”‚IAudioService â”‚            â”‚IGameStateMgr â”‚            â”‚ISceneLoading â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                            â”‚                            â”‚
        â–¼                            â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BGMManager   â”‚            â”‚ State Events â”‚            â”‚Scene Loading â”‚
â”‚AmbientManagerâ”‚            â”‚ Transitions  â”‚            â”‚ Management   â”‚
â”‚EffectManager â”‚            â”‚              â”‚            â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚·ã‚¹ãƒ†ãƒ è©³ç´°å›³

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          AudioManager               â”‚
                    â”‚      implements IAudioService       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚       Audio Category Managers       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                      â”‚                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    BGMManager     â”‚   â”‚ AmbientManager  â”‚   â”‚  EffectManager  â”‚
    â”‚  (Background)     â”‚   â”‚ (Environment)   â”‚   â”‚ (Sound Effects) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                      â”‚                     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      Specialized Audio Systems      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                      â”‚                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚SpatialAudioMgr    â”‚   â”‚DynamicAudioEnv  â”‚   â”‚StealthAudioCoordâ”‚
    â”‚ (3D Positioning)  â”‚   â”‚(Adaptive Audio) â”‚   â”‚(Stealth System) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                      â”‚                     â”‚
              â–¼                      â–¼                     â–¼
       [Unity Audio]          [Weather/Time]        [NPCAudioSensor]
       [3D Engine]            [Adaptation]          [AI Detection]
```

### ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ãƒ•ãƒ­ãƒ¼

```
[SystemInitializer.Awake()]
            â”‚
            â–¼
    [DiscoverSystems()]
            â”‚
            â–¼
  [IInitializable Components]
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
    â–¼               â–¼
[Sort by Priority] [IServiceLocatorRegistrable]
    â”‚               â”‚
    â–¼               â–¼
[Initialize()]   [RegisterServices()]
    â”‚               â”‚
    â–¼               â–¼
[AudioService]   [ServiceLocator.Register()]
[GameManager]         â”‚
[UIService]           â–¼
[...]           [Service Available]
```

---

## ã¾ã¨ã‚

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å¼·ã¿

1. **é«˜ã„æ‹¡å¼µæ€§**: ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰æ§‹é€ ã«ã‚ˆã‚‹é–¢å¿ƒäº‹ã®åˆ†é›¢
2. **ç–çµåˆè¨­è¨ˆ**: ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã¨ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼ã®çµ„ã¿åˆã‚ã›
3. **ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®è¨­è¨ˆ
4. **æ®µéšçš„ç§»è¡Œ**: å¾Œæ–¹äº’æ›æ€§ã‚’ä¿ã¡ãªãŒã‚‰ã®ãƒ¢ãƒ€ãƒ³åŒ–
5. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: ObjectPoolã€HashSetç­‰ã®æœ€é©åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³

### ä»Šå¾Œã®é€²åŒ–æ–¹å‘

1. **Service Locator â†’ Dependency Injection**: ã‚ˆã‚Šæ˜ç¤ºçš„ãªä¾å­˜é–¢ä¿‚ç®¡ç†
2. **MVVM ãƒ‘ã‚¿ãƒ¼ãƒ³å°å…¥**: UIå±¤ã®ã•ã‚‰ãªã‚‹åˆ†é›¢
3. **Reactive Extensions**: ã‚ˆã‚Šå®£è¨€çš„ãªã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
4. **ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–**: å¤§è¦æ¨¡é–‹ç™ºã§ã®ç‹¬ç«‹æ€§å‘ä¸Š

### å“è³ªä¿è¨¼

- **åå‰ç©ºé–“çµ±ä¸€**: `asterivo.Unity60.*` ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Œå…¨çµ±ä¸€æ¸ˆã¿ âœ…
- **ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼**: 0ä»¶ âœ…
- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ä¸€è²«æ€§**: Core/Featuresåˆ†é›¢ç¶­æŒ âœ…
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: æ®µéšçš„æ‹¡å……ä¸­ ğŸ”„

ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€Unity 6ã®æœ€æ–°æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ãªãŒã‚‰ã€ä¿å®ˆæ€§ã¨æ‹¡å¼µæ€§ã‚’ä¸¡ç«‹ã—ãŸè¨­è¨ˆã¨ãªã£ã¦ã„ã¾ã™ã€‚

---

*Document generated by Claude Code Assistant*  
*Last updated: 2025å¹´9æœˆ11æ—¥*